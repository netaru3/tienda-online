<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda</title>
</head>
<body>
    <h1 id="bienvenida">bienvenido </h1> 
    <button onclick="redireccionarlogin()" id="login">iniciar sesion</button>
    <button onclick="redireccionarregistro()" id="registro">registrarse</button>
    <h2>Mira todo los productos que tenemos!</h2>

    <div id="contenedor">

    </div>
    

    <button onclick="cerrarsesion()" id="sesion">cerrar sesi√≥n</button>
</body>
<script type="module">



    window.redireccionarregistro= function redireccionarregistro(){
        window.location.href="/"
    }
      window.redireccionarlogin= function redireccionarlogin(){
        window.location.href="/data"
    }
    let nombre= "<%= nombre %>"

    if(nombre==="undefined"){nombre="visitante"}

    document.getElementById("bienvenida").textContent+=" "+nombre

    if(nombre!=="visitante"){document.getElementById("login").remove();
        document.getElementById("registro").remove()
    }
  window.cerrarsesion= async function cerrarsesion(){
       await fetch(`/tienda/cerrarsesion`)
       window.location.href="/data"
    }
    if(nombre==="visitante"){document.getElementById("sesion").remove()}

    let productos=await fetch("/verproductos").then(function(res){return res.json()})

    console.log(productos)
    function mostrarproductos(i){
        let nombre= document.createElement("h3")
        nombre.textContent=productos[i].producto_nombre;

        let precio= document.createElement("h4")
        precio.textContent="precio: "+productos[i].producto_precio

        let descripcion=document.createElement("p")
        descripcion.textContent=productos[i].producto_descripcion

   let imagen= document.createElement("img")
   imagen.src=`/${productos[i].producto_imagen}`
   imagen.width=500
   console.log(imagen.src)
 
   let contenedor= document.getElementById("contenedor")
   contenedor.innerHTML +=`
    <div class="card-header">
        <div class="card-name">
            <a href="/producto/${nombre.textContent}">${nombre.textContent}</a>
        </div>
    </div>

    <a href="/producto/${nombre.textContent}">
        <div class="card-image-container">
            <img src="${imagen.src}" alt="${nombre.textContent}" width="500" class="card-image">
        </div>
    </a>
    
     <div class="card-header">
        <div class="card-name">
            <a href="/producto/${nombre.textContent}">${precio.textContent}</a>
        </div>
    </div>

    <div class="card-body">
        <div class="card-description">
            ${descripcion.textContent}
        </div>
    </div>
`



}
let i=0
while(i<productos.length){mostrarproductos(i);++i}



</script>
</html>
